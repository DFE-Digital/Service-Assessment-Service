@using GovUk.Frontend.AspNetCore.ModelBinding
@using ServiceAssessmentService.WebApp.Controllers.Book
@model ServiceAssessmentService.WebApp.Controllers.Book.EndDateViewModel;

@{
    ViewData["Title"] = "Index";
}

<div class="main--content">

    <div class="main--inside-container">

        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <form asp-controller="BookingRequest" asp-action="EndDate" asp-route-id="@Model.RequestId">

                    <govuk-radios name="@Model.IsEndDateKnownFormElementName" id-prefix="end_date_known" asp-for="IsEndDateKnownValue">
                        <govuk-radios-fieldset>
                            <govuk-radios-fieldset-legend is-page-heading="false" class="govuk-fieldset__legend--m">
                                Do you have an end date for your discovery?
                            </govuk-radios-fieldset-legend>

                            <govuk-radios-hint>
                                Select one option.
                            </govuk-radios-hint>

                            
                            @if (Model.AllErrors.Any())
                            {
                                <govuk-radios-error-message error-items="Model.ErrorItems">@(string.Join(", ", Model.AllErrors))</govuk-radios-error-message>
                            }
                            
                            <govuk-radios-item value="@Model.IsEndDateKnownValueYes">
                                Yes
                                <govuk-radios-item-conditional>
                                    <govuk-date-input id="@EndDateDto.DateFormNamePrefix" name-prefix="@EndDateDto.DateFormNamePrefix">
                                        <govuk-date-input-fieldset>
                                            <govuk-date-input-fieldset-legend class="govuk-fieldset__legend--s">
                                                End date
                                            </govuk-date-input-fieldset-legend>
                                            <govuk-date-input-hint>
                                                For example, 18 2 2023.
                                            </govuk-date-input-hint>

                                            @* @if (Model.AllErrors.Any()) *@
                                            @* { *@
                                            @*     <govuk-date-input-error-message error-items="Model.ErrorItems">@(string.Join(", ", Model.AllErrors))</govuk-date-input-error-message> *@
                                            @* } *@
                                            
                                            <govuk-date-input-day value="@Model.EndDateDayValue"/>
                                            <govuk-date-input-month value="@Model.EndDateMonthValue"/>
                                            <govuk-date-input-year value="@Model.EndDateYearValue"/>
                                        </govuk-date-input-fieldset>
                                    </govuk-date-input>
                                </govuk-radios-item-conditional>
                            </govuk-radios-item>

                            <govuk-radios-item value="@Model.IsEndDateKnownValueNo">
                                No
                            </govuk-radios-item>
                        </govuk-radios-fieldset>
                    </govuk-radios>


                    <div class="govuk-button-group">
                        <govuk-button type="submit">Save and continue</govuk-button>
                        @Html.ActionLink("Skip and return to later", "Tasks", "BookingRequest", new {id = Model.RequestId}, new {@class = "govuk-link"})
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
